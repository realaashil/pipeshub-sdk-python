"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from .oauthcredentials import OAuthCredentials, OAuthCredentialsTypedDict
from .otpcredentials import OtpCredentials, OtpCredentialsTypedDict
from .passwordcredentials import PasswordCredentials, PasswordCredentialsTypedDict
from pipeshub.types import BaseModel, UNSET_SENTINEL
import pydantic
from pydantic import model_serializer
from typing import Literal, Optional, Union
from typing_extensions import Annotated, NotRequired, TypeAliasType, TypedDict


Method = Literal[
    "samlSso",
    "otp",
    "password",
    "google",
    "microsoft",
    "azureAd",
    "oauth",
]
r"""Authentication method to use"""


CredentialsTypedDict = TypeAliasType(
    "CredentialsTypedDict",
    Union[
        PasswordCredentialsTypedDict,
        OtpCredentialsTypedDict,
        OAuthCredentialsTypedDict,
        str,
    ],
)
r"""Credentials based on the authentication method"""


Credentials = TypeAliasType(
    "Credentials", Union[PasswordCredentials, OtpCredentials, OAuthCredentials, str]
)
r"""Credentials based on the authentication method"""


class AuthenticateRequestTypedDict(TypedDict):
    r"""Request to authenticate using specified method.
    **Credential format varies by method:**
    - `password`: `{ password: \"string\" }`
    - `otp`: `{ otp: \"123456\" }` (6-digit code)
    - `google`: `\"google-id-token-string\"`
    - `microsoft`: `{ accessToken: \"...\", idToken: \"...\" }`
    - `azureAd`: `{ accessToken: \"...\", idToken: \"...\" }`
    - `oauth`: `{ accessToken: \"...\", idToken: \"...\" }`
    - `samlSso`: handled via redirect flow

    """

    method: Method
    r"""Authentication method to use"""
    credentials: CredentialsTypedDict
    r"""Credentials based on the authentication method"""
    email: NotRequired[str]
    r"""Optional email for verification (used with some OAuth methods)"""
    cf_turnstile_response: NotRequired[str]
    r"""Cloudflare Turnstile CAPTCHA token (optional, if CAPTCHA is enabled)"""


class AuthenticateRequest(BaseModel):
    r"""Request to authenticate using specified method.
    **Credential format varies by method:**
    - `password`: `{ password: \"string\" }`
    - `otp`: `{ otp: \"123456\" }` (6-digit code)
    - `google`: `\"google-id-token-string\"`
    - `microsoft`: `{ accessToken: \"...\", idToken: \"...\" }`
    - `azureAd`: `{ accessToken: \"...\", idToken: \"...\" }`
    - `oauth`: `{ accessToken: \"...\", idToken: \"...\" }`
    - `samlSso`: handled via redirect flow

    """

    method: Method
    r"""Authentication method to use"""

    credentials: Credentials
    r"""Credentials based on the authentication method"""

    email: Optional[str] = None
    r"""Optional email for verification (used with some OAuth methods)"""

    cf_turnstile_response: Annotated[
        Optional[str], pydantic.Field(alias="cf-turnstile-response")
    ] = None
    r"""Cloudflare Turnstile CAPTCHA token (optional, if CAPTCHA is enabled)"""

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(["email", "cf-turnstile-response"])
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m


try:
    AuthenticateRequest.model_rebuild()
except NameError:
    pass

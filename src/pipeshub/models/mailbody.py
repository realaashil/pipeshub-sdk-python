"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from .accountcreationtemplatedata import (
    AccountCreationTemplateData,
    AccountCreationTemplateDataTypedDict,
)
from .appuserinvitetemplatedata import (
    AppUserInviteTemplateData,
    AppUserInviteTemplateDataTypedDict,
)
from .loginwithotptemplatedata import (
    LoginWithOTPTemplateData,
    LoginWithOTPTemplateDataTypedDict,
)
from .resetpasswordtemplatedata import (
    ResetPasswordTemplateData,
    ResetPasswordTemplateDataTypedDict,
)
from .suspiciouslogintemplatedata import (
    SuspiciousLoginTemplateData,
    SuspiciousLoginTemplateDataTypedDict,
)
from pipeshub.types import BaseModel, UNSET_SENTINEL
import pydantic
from pydantic import model_serializer
from typing import List, Literal, Optional, Union
from typing_extensions import Annotated, NotRequired, TypeAliasType, TypedDict


EmailTemplateType = Literal[
    "loginWithOTP",
    "resetPassword",
    "accountCreation",
    "appuserInvite",
    "suspiciousLoginAttempt",
]
r"""Type of email template to use. Each template has specific `templateData` requirements:
- `loginWithOTP`: OTP authentication email
- `resetPassword`: Password reset link email
- `accountCreation`: Welcome email for new organizations
- `appuserInvite`: Invitation email to join an organization
- `suspiciousLoginAttempt`: Security alert for multiple failed OTP attempts

"""


TemplateDataTypedDict = TypeAliasType(
    "TemplateDataTypedDict",
    Union[
        SuspiciousLoginTemplateDataTypedDict,
        LoginWithOTPTemplateDataTypedDict,
        ResetPasswordTemplateDataTypedDict,
        AccountCreationTemplateDataTypedDict,
        AppUserInviteTemplateDataTypedDict,
    ],
)
r"""Dynamic data to populate the email template. Required fields depend on <code>emailTemplateType</code>.<br><br>
<b>Template Data Requirements:</b><br>
<ul>
<li><b>loginWithOTP:</b> See <code>LoginWithOTPTemplateData</code> - requires <code>name</code>, <code>otp</code></li>
<li><b>resetPassword:</b> See <code>ResetPasswordTemplateData</code> - requires <code>name</code>, <code>link</code></li>
<li><b>accountCreation:</b> See <code>AccountCreationTemplateData</code> - requires <code>orgName</code>, <code>link</code></li>
<li><b>appuserInvite:</b> See <code>AppUserInviteTemplateData</code> - requires <code>invitee</code>, <code>orgName</code>, <code>link</code></li>
<li><b>suspiciousLoginAttempt:</b> See <code>SuspiciousLoginTemplateData</code> - requires <code>link</code></li>
</ul>

"""


TemplateData = TypeAliasType(
    "TemplateData",
    Union[
        SuspiciousLoginTemplateData,
        LoginWithOTPTemplateData,
        ResetPasswordTemplateData,
        AccountCreationTemplateData,
        AppUserInviteTemplateData,
    ],
)
r"""Dynamic data to populate the email template. Required fields depend on <code>emailTemplateType</code>.<br><br>
<b>Template Data Requirements:</b><br>
<ul>
<li><b>loginWithOTP:</b> See <code>LoginWithOTPTemplateData</code> - requires <code>name</code>, <code>otp</code></li>
<li><b>resetPassword:</b> See <code>ResetPasswordTemplateData</code> - requires <code>name</code>, <code>link</code></li>
<li><b>accountCreation:</b> See <code>AccountCreationTemplateData</code> - requires <code>orgName</code>, <code>link</code></li>
<li><b>appuserInvite:</b> See <code>AppUserInviteTemplateData</code> - requires <code>invitee</code>, <code>orgName</code>, <code>link</code></li>
<li><b>suspiciousLoginAttempt:</b> See <code>SuspiciousLoginTemplateData</code> - requires <code>link</code></li>
</ul>

"""


class AttachmentTypedDict(TypedDict):
    filename: NotRequired[str]
    r"""Name of the attachment file"""
    content: NotRequired[str]
    r"""Base64-encoded file content or raw string content"""
    content_type: NotRequired[str]
    r"""MIME type of the attachment"""


class Attachment(BaseModel):
    filename: Optional[str] = None
    r"""Name of the attachment file"""

    content: Optional[str] = None
    r"""Base64-encoded file content or raw string content"""

    content_type: Annotated[Optional[str], pydantic.Field(alias="contentType")] = None
    r"""MIME type of the attachment"""

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(["filename", "content", "contentType"])
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m


class MailBodyTypedDict(TypedDict):
    r"""Request body for sending transactional emails via pre-defined templates.

    **Template-specific templateData requirements:**

    | Template | Required Fields | Description |
    |----------|----------------|-------------|
    | `loginWithOTP` | `name`, `otp` | User's name and 6-digit OTP code |
    | `resetPassword` | `name`, `link` | User's name and password reset URL |
    | `accountCreation` | `orgName`, `link` | Organization name and login URL |
    | `appuserInvite` | `invitee`, `orgName`, `link` | Inviter name, org name, and invitation URL |
    | `suspiciousLoginAttempt` | `link` | Support contact URL |

    **Note:** The actual \"From\" address is taken from the SMTP configuration, not from `fromEmailDomain`.
    The `fromEmailDomain` field is stored for audit purposes only.

    """

    email_template_type: EmailTemplateType
    r"""Type of email template to use. Each template has specific `templateData` requirements:
    - `loginWithOTP`: OTP authentication email
    - `resetPassword`: Password reset link email
    - `accountCreation`: Welcome email for new organizations
    - `appuserInvite`: Invitation email to join an organization
    - `suspiciousLoginAttempt`: Security alert for multiple failed OTP attempts

    """
    send_email_to: List[str]
    r"""List of recipient email addresses (at least one required)"""
    product_name: NotRequired[str]
    r"""Name of the product sending the email (used in templates for branding)"""
    is_auto_email: NotRequired[bool]
    r"""Flag indicating if this is an automated system email (for tracking/filtering purposes)"""
    from_email_domain: NotRequired[str]
    r"""Sender email address for audit logging. **Note:** The actual \"From\" address used
    in the email is taken from the SMTP server configuration (`smtpConfig.fromEmail`),
    not this field. This field is stored in the database for record-keeping.

    """
    subject: NotRequired[str]
    r"""Email subject line"""
    template_data: NotRequired[TemplateDataTypedDict]
    r"""Dynamic data to populate the email template. Required fields depend on <code>emailTemplateType</code>.<br><br>
    <b>Template Data Requirements:</b><br>
    <ul>
    <li><b>loginWithOTP:</b> See <code>LoginWithOTPTemplateData</code> - requires <code>name</code>, <code>otp</code></li>
    <li><b>resetPassword:</b> See <code>ResetPasswordTemplateData</code> - requires <code>name</code>, <code>link</code></li>
    <li><b>accountCreation:</b> See <code>AccountCreationTemplateData</code> - requires <code>orgName</code>, <code>link</code></li>
    <li><b>appuserInvite:</b> See <code>AppUserInviteTemplateData</code> - requires <code>invitee</code>, <code>orgName</code>, <code>link</code></li>
    <li><b>suspiciousLoginAttempt:</b> See <code>SuspiciousLoginTemplateData</code> - requires <code>link</code></li>
    </ul>

    """
    send_cc_to: NotRequired[List[str]]
    r"""Optional list of CC recipient email addresses"""
    attachments: NotRequired[List[AttachmentTypedDict]]
    r"""Optional email attachments (uses nodemailer attachment format)"""


class MailBody(BaseModel):
    r"""Request body for sending transactional emails via pre-defined templates.

    **Template-specific templateData requirements:**

    | Template | Required Fields | Description |
    |----------|----------------|-------------|
    | `loginWithOTP` | `name`, `otp` | User's name and 6-digit OTP code |
    | `resetPassword` | `name`, `link` | User's name and password reset URL |
    | `accountCreation` | `orgName`, `link` | Organization name and login URL |
    | `appuserInvite` | `invitee`, `orgName`, `link` | Inviter name, org name, and invitation URL |
    | `suspiciousLoginAttempt` | `link` | Support contact URL |

    **Note:** The actual \"From\" address is taken from the SMTP configuration, not from `fromEmailDomain`.
    The `fromEmailDomain` field is stored for audit purposes only.

    """

    email_template_type: Annotated[
        EmailTemplateType, pydantic.Field(alias="emailTemplateType")
    ]
    r"""Type of email template to use. Each template has specific `templateData` requirements:
    - `loginWithOTP`: OTP authentication email
    - `resetPassword`: Password reset link email
    - `accountCreation`: Welcome email for new organizations
    - `appuserInvite`: Invitation email to join an organization
    - `suspiciousLoginAttempt`: Security alert for multiple failed OTP attempts

    """

    send_email_to: Annotated[List[str], pydantic.Field(alias="sendEmailTo")]
    r"""List of recipient email addresses (at least one required)"""

    product_name: Annotated[Optional[str], pydantic.Field(alias="productName")] = None
    r"""Name of the product sending the email (used in templates for branding)"""

    is_auto_email: Annotated[Optional[bool], pydantic.Field(alias="isAutoEmail")] = (
        False
    )
    r"""Flag indicating if this is an automated system email (for tracking/filtering purposes)"""

    from_email_domain: Annotated[
        Optional[str], pydantic.Field(alias="fromEmailDomain")
    ] = None
    r"""Sender email address for audit logging. **Note:** The actual \"From\" address used
    in the email is taken from the SMTP server configuration (`smtpConfig.fromEmail`),
    not this field. This field is stored in the database for record-keeping.

    """

    subject: Optional[str] = None
    r"""Email subject line"""

    template_data: Annotated[
        Optional[TemplateData], pydantic.Field(alias="templateData")
    ] = None
    r"""Dynamic data to populate the email template. Required fields depend on <code>emailTemplateType</code>.<br><br>
    <b>Template Data Requirements:</b><br>
    <ul>
    <li><b>loginWithOTP:</b> See <code>LoginWithOTPTemplateData</code> - requires <code>name</code>, <code>otp</code></li>
    <li><b>resetPassword:</b> See <code>ResetPasswordTemplateData</code> - requires <code>name</code>, <code>link</code></li>
    <li><b>accountCreation:</b> See <code>AccountCreationTemplateData</code> - requires <code>orgName</code>, <code>link</code></li>
    <li><b>appuserInvite:</b> See <code>AppUserInviteTemplateData</code> - requires <code>invitee</code>, <code>orgName</code>, <code>link</code></li>
    <li><b>suspiciousLoginAttempt:</b> See <code>SuspiciousLoginTemplateData</code> - requires <code>link</code></li>
    </ul>

    """

    send_cc_to: Annotated[Optional[List[str]], pydantic.Field(alias="sendCcTo")] = None
    r"""Optional list of CC recipient email addresses"""

    attachments: Optional[List[Attachment]] = None
    r"""Optional email attachments (uses nodemailer attachment format)"""

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(
            [
                "productName",
                "isAutoEmail",
                "fromEmailDomain",
                "subject",
                "templateData",
                "sendCcTo",
                "attachments",
            ]
        )
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m


try:
    Attachment.model_rebuild()
except NameError:
    pass
try:
    MailBody.model_rebuild()
except NameError:
    pass

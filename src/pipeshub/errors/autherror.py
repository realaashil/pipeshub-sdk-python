"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from dataclasses import dataclass, field
import httpx
from pipeshub.errors import PipeshubError
from pipeshub.types import BaseModel
import pydantic
from typing import Optional
from typing_extensions import Annotated


class AuthErrorData(BaseModel):
    error: Optional[str] = None
    r"""Error type identifier"""
    message: Optional[str] = None
    r"""Human-readable error message"""
    code: Optional[str] = None
    r"""Error code for programmatic handling"""
    status_code: Annotated[Optional[int], pydantic.Field(alias="statusCode")] = None
    r"""HTTP status code"""


@dataclass(unsafe_hash=True)
class AuthError(PipeshubError):
    r"""Authentication error response with details for debugging and user feedback.<br><br>
    <b>Common Error Codes:</b><br>
    <ul>
    <li><code>INVALID_CREDENTIALS</code> - Wrong password or OTP</li>
    <li><code>ACCOUNT_BLOCKED</code> - Account locked after 5 failed attempts</li>
    <li><code>SESSION_EXPIRED</code> - Session token has expired</li>
    <li><code>OTP_EXPIRED</code> - OTP code has expired (10 min validity)</li>
    <li><code>USER_NOT_FOUND</code> - Email not registered</li>
    <li><code>INVALID_TOKEN</code> - JWT token is invalid or malformed</li>
    <li><code>METHOD_NOT_ALLOWED</code> - Auth method not enabled for org</li>
    </ul>

    """

    data: AuthErrorData = field(hash=False)

    def __init__(
        self,
        data: AuthErrorData,
        raw_response: httpx.Response,
        body: Optional[str] = None,
    ):
        fallback = body or raw_response.text
        message = str(data.message) or fallback
        super().__init__(message, raw_response, body)
        object.__setattr__(self, "data", data)
